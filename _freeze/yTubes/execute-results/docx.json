{
  "hash": "fc76ea9d82ff1f9c35beb9293fa4fb98",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Y Tubes\"\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(gridExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'gridExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(glue)\nlibrary(ggsignif)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nytubes <-\nread_excel(\"yTubes.xlsx\")\n\nytubes_analysis <-\n  ytubes %>%\n  mutate(trial = paste(plus, minus, sep = \"-\")) %>%\n  dplyr::select(-c(plus, minus, x_count, date)) %>%\n  group_by(species, trial) %>%\n  reframe(plus_count = sum(plus_count),\n          minus_count = sum(minus_count)) %>%\n  filter(species == \"lissogaster\",\n         trial == \"ww-blank\") %>%\n  dplyr::select(-c(species, trial))\n\nytubes_analysis %>%\n  chisq.test()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  .\nX-squared = 7.7586, df = 1, p-value = 0.005346\n```\n\n\n:::\n\n```{.r .cell-code}\nytubes_plot_data <-\n  ytubes %>%\n  mutate(trial = paste(plus, minus, sep = \"-\")) %>%\n  dplyr::select(-date, -plus, -minus, -x_count) %>%\n  pivot_longer(-c(species, trial),\n               names_to = \"variable\",\n               values_to = \"value\") %>%\n  mutate(variable = ifelse(grepl(\"minus\", variable),\n                           str_extract(trial, \"(?<=-).*$\"),\n                           str_extract(trial, \"^[^-]+\"))) %>%\n  group_by(species, trial, variable) %>%\n  reframe(value = sum(value)) %>%\n  mutate(variable = case_when(variable == \"blank\" ~ \"Pure Air\",\n                              variable == \"ww\" ~ \"Winter Wheat\",\n                              variable == \"brome\" ~ \"B. inermis\",\n                              TRUE ~ variable)) %>%\n  mutate(variable = factor(variable, \n                           levels = c(\"B. inermis\", \n                                      \"Winter Wheat\", \n                                      \"Pure Air\"))) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nytubes_plot_data %>%\n  mutate(species = if_else(species == \"lissogaster\",\n                           \"B. lissogaster\",\n                           \"B. cephi\")) %>%\n  ggplot() +\n  geom_bar(stat = \"identity\",\n           aes(x = variable, y = value, fill = species),\n           position = position_dodge(),\n           color = \"black\") +\n  facet_grid(species~trial, scale = \"free_x\") +\n  theme_bw() +\n  scale_fill_brewer(palette = \"Greys\") +\n  scale_x_discrete(labels = c(expression(italic(\"B. inermis\")),\n                              \"Winter Wheat\",\n                              \"Pure Air\")) +\n  labs(y = \"Number of Females\",\n       x = NULL,\n       fill = NULL) +\n  theme(strip.text.y = element_text(face = \"italic\"),\n        strip.text.x = element_blank(),\n        strip.background.x = element_blank(),\n        legend.position = \"none\",\n        panel.grid.major.x = element_blank())\n```\n\n::: {.cell-output-display}\n![](yTubes_files/figure-docx/facet wrap plot-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# with significance star\nytubes_plot_data %>%\n  filter(species == \"lissogaster\",\n         trial == \"brome-blank\") %>%\n  ggplot() +\n  geom_bar(stat = \"identity\",\n           color = \"black\",\n           fill = \"white\",\n           aes(x = variable, y = value)) +\n  theme_bw() +\n  theme(strip.text.x = element_text(size=0)) +\n  scale_fill_brewer(palette = \"Greys\") +\n  labs(x = NULL,\n       y = \"Number of females\") +\n  geom_signif(aes(x = variable, \n                  y = value),\n              comparisons = list(c(\"B. inermis\", \"Pure Air\")), \n              annotations = c(\"***\"), \n              textsize = 3.5, \n              tip_length = 0.02)\n```\n\n::: {.cell-output-display}\n![](yTubes_files/figure-docx/significance star-1.png)\n:::\n:::\n\n\n\n\n\nytubes %>%\n  pivot_longer(-c(date, species, plus_count, minus_count, x_count),\n               values_to = \"source\",\n               names_to = \"source2\")\nview(ytubes)\nytubes %>%\n  dplyr::select(-c(date, species, plus_count, minus_count))\n\n\nytubes %>%\n  mutate(trial = paste(plus, minus, sep = \"-\")) %>%\n  dplyr::select(-date, -plus, -minus, -x_count) %>%\n  pivot_longer(-c(species, trial),\n               names_to = \"variable\",\n               values_to = \"value\") %>%\n  ggplot() +\n  geom_bar(stat = \"identity\",\n           aes(x = variable, y = value, fill = species),\n           position = position_dodge()) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  facet_wrap(~trial)\n         \n# standard_error <- \n  ytubes %>%\n  mutate(trial = paste(plus, minus, sep = \"-\")) %>%\n  dplyr::select(-date, -plus, -minus, -x_count) %>%\n  pivot_longer(-c(species, trial),\n               names_to = \"variable\",\n               values_to = \"value\") %>%\n  group_by(species, trial, variable) %>%\n  summarise(\n    mean = mean(value),\n    sd = sd(value),\n    n = n(),\n    se = sd / sqrt(n)\n  )       \n\n  \nytube_analysis <-\n  ytubes %>%\n  mutate(trial = paste(plus, minus, sep = \"-\")) %>%\n  dplyr::select(-date, -plus, -minus, -x_count) %>%\n  pivot_longer(-c(species, trial),\n               names_to = \"variable\",\n               values_to = \"value\") \n\nytube_analysis %>%\n  lm(value ~ trial + species + variable, data = .) %>%\n  summary()\n\n\n\n\n\n\n  \n      \n```\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example data (replace with your actual observed counts)\nobserved <- c(40, 60)  # Example: 40 insects chose odor A, 60 chose odor B\n\n# Calculate total number of observations\ntotal_insects <- sum(observed)\n\n# Calculate expected proportions assuming no preference (0.5 for each)\nexpected_proportions <- c(0.5, 0.5)\n\n# Calculate expected counts based on total number of insects\nexpected <- expected_proportions * total_insects\n\n# Perform chi-square test\nchi_square_result <- chisq.test(observed, p = expected_proportions)\n\n# Print the result\nprint(chi_square_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  observed\nX-squared = 4, df = 1, p-value = 0.0455\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "yTubes_files/figure-docx"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}